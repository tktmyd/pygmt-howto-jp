{"version":3,"kind":"Notebook","sha256":"7d65b33fec1c0f0291b6dda0b9a879dedd06dc661881590c51be75c5ddc05bce","slug":"timeseries","location":"/timeseries.ipynb","dependencies":[],"frontmatter":{"title":"時系列データの可視化","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"github":"https://github.com/tktmyd/pygmt-howto-jp","copyright":"2021-2025. All Rights Reserved","settings":{"output_stderr":"remove-warn"},"numbering":{"title":{"offset":1}},"source_url":"https://github.com/tktmyd/pygmt-howto-jp/blob/main/src/timeseries.ipynb","edit_url":"https://github.com/tktmyd/pygmt-howto-jp/edit/main/src/timeseries.ipynb","exports":[{"format":"ipynb","filename":"timeseries.ipynb","url":"/pygmt-howto-jp/build/timeseries-7be05b8f2462856229340c2c8cf7a532.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import pygmt\nimport datetime","visibility":"show","key":"pS8VLPyAlX"},{"type":"outputs","id":"IytMys9bDQN21orB_Mhwh","children":[],"visibility":"show","key":"pAGGHuOXrl"}],"visibility":"show","key":"Hk3FWS17lv"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"震源分布に用いたデータから，地震発生日とマグにチュードからなる M-T 図を作成してみましょう．まずは","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"R2E8qlPaAz"},{"type":"inlineCode","value":"datetime","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yQx6SjlqVh"},{"type":"text","value":"モジュールを用いて，震源カタログの年・月・日のデータをまとめて日付オブジェクトのリストにします．","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rksL4310u5"}],"key":"wG3vQ5b5ML"}],"visibility":"show","key":"JPQ7h94A5Z"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# 昔のバージョンは pygmt.datasets.load_japan_quakes() でした\nhypdata = pygmt.datasets.load_sample_data(name='japan_quakes')\nhyptim = [datetime.datetime(yr, mo, dy) for yr, mo, dy in zip(hypdata.year, hypdata.month, hypdata.day)]\nhypmag = hypdata.magnitude","visibility":"show","key":"vdFOkpAqt0"},{"type":"outputs","id":"7HKFemlxWQNLSNQqxR1vl","children":[],"visibility":"show","key":"oi8E1EZufs"}],"visibility":"show","key":"ZirdrGNQxQ"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"ここではリスト","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n45G4MrNEu"},{"type":"inlineCode","value":"hyptim","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cpb8DzwWYw"},{"type":"text","value":"を生成するのにPythonの内包表記を活用しています．この表現は，愚直に書くと","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K0fVU9gLVR"}],"key":"N3HZe3WSzS"},{"type":"code","lang":"python","value":"hyptim = []\nfor yr, mo, dy in zip(hypdata.year, hypdata.month, hypdata.day):\n    hyptim.append(datetime.datetime(yr, mo, dy))","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"key":"WT2GlDTUrr"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"と等価です．","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"uaIqJjh50g"}],"key":"Exp7wTtmfX"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"また，","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"HgTCHaDR4v"},{"type":"inlineCode","value":"for","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Tpqrv18nu1"},{"type":"text","value":"文に現れる ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Dny8T529oj"},{"type":"inlineCode","value":"zip","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"LLnZh8egw8"},{"type":"text","value":" 関数は複数のリスト（など）の要素をまとめる関数で，ループで変数 ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"MyaHMrNeaX"},{"type":"inlineCode","value":"yr","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"h5rVZbIoaU"},{"type":"text","value":", ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"wcJA647amb"},{"type":"inlineCode","value":"mo","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"rg5QFu4t53"},{"type":"text","value":", ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"TPeq2BZ7Ra"},{"type":"inlineCode","value":"dy","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"nJrbN9W6Hb"},{"type":"text","value":" にそれぞれ ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"HiXrSUXnZZ"},{"type":"inlineCode","value":"hypdata.year","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"IkHYQ4Cvb1"},{"type":"text","value":"，","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"UcksNoRdZT"},{"type":"inlineCode","value":"hypdata.month","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"gXQItom28z"},{"type":"text","value":", ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"D8I3sADoF4"},{"type":"inlineCode","value":"hypdata.day","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"rmRvUo9y1v"},{"type":"text","value":" から一つずつの要素を代入してくれます．．","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"nhJ4lXTZ97"}],"key":"BoQtgFuiGL"}],"visibility":"show","key":"czcsRn3HyY"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = pygmt.Figure()\n\nfig.basemap(\n    projection = 'X15c/5c', \n    region     = ['1987-01-01', '1987-12-31', 0, 8], \n    frame      = ['WS', 'pxa1o', 'sxa1Y+lYear/Month', 'yaf+lMagnitude']\n)\n\nfor dy, mag in zip(hyptim, hypmag):\n    \n    fig.plot(\n        x    = [dy, dy],\n        y    = [0, mag],\n        pen  = 'default,black'\n    )\n    \n\nfig.plot(\n    x     = hyptim, \n    y     = hypmag, \n    style = 'c0.2c', \n    fill  = '100/100/255@30', \n    pen   = 'default,black'\n)\n\nfig.show()","visibility":"show","key":"QksfrSyjtc"},{"type":"outputs","id":"uyU7AtIjgrhRkU3Lp0sa8","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{"image/png":{"width":500}},"data":{"image/png":{"content_type":"image/png","hash":"0d68ff0f145f31f51e3631d036a8a2f5","path":"/0d68ff0f145f31f51e3631d036a8a2f5.png"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"e6Z1mm9cgX"}],"visibility":"show","key":"OboB1so1ik"}],"visibility":"show","key":"xFYmVWJuDa"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"まず ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cUNrhsTxYb"},{"type":"inlineCode","value":"fig.basemap","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fVsJNFzYGh"},{"type":"text","value":" で枠を描画しています．領域の横軸は ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NdGKMF4sL9"},{"type":"inlineCode","value":"YYYY-MM-DD","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jPwYmGIyLg"},{"type":"text","value":" の日付ISOフォーマットで指定しています．","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j2ZLnbcweh"},{"type":"inlineCode","value":"frame","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hN9Pn15LDE"},{"type":"text","value":" については，横軸は軸のすぐそば（primary）に月名（","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PoARqGInq0"},{"type":"inlineCode","value":"o","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lmxRqAKVn8"},{"type":"text","value":"）を，少し離れて（secondary）年（","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N4uIdCYGTk"},{"type":"inlineCode","value":"Y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i5RNYRnHc6"},{"type":"text","value":"）を描画しています．このように二種類の軸情報を描画するには，","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XZ9ceWdAY9"},{"type":"inlineCode","value":"px","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rOLKz5lXoo"},{"type":"text","value":" (primary) と ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NlXKYZ2T7Z"},{"type":"inlineCode","value":"sx","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JP4Gz6GeHi"},{"type":"text","value":" (secondary) をそれぞれ指定すればよいです．","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"slpgR9VWsb"}],"key":"QKUDmw5odg"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"次のforループでは，準備してあった ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"u9cNd5Heic"},{"type":"inlineCode","value":"datetime","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"knmuKhv9rH"},{"type":"text","value":" 型の日付とマグニチュードから","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CFusTygAsj"},{"type":"inlineCode","value":"zip","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zE06ROJs7j"},{"type":"text","value":"関数を用いてそれぞれ一つづつ抜き出し，縦棒を描画しています．シェルスクリプトの場合は，区切り行（デフォルトは ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cLkCVnoz6h"},{"type":"inlineCode","value":">","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gMjUYp5vp4"},{"type":"text","value":" が1文字目にある行）を用いて","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cp7cZWmcS6"}],"key":"FpWQnZ4XMj"},{"type":"code","lang":"text","value":"> \n1987-01-01 0\n1987-01-01 5\n>\n1987-02-05 0\n1987-02-05 4.5\n>\n...","position":{"start":{"line":5,"column":1},"end":{"line":14,"column":1}},"key":"UuYj0abxeo"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"のようなマルチセグメントデータを作って一斉にプロットできます．\nしかし，PyGMTにおいて変数受け渡しでマルチセグメントデータを","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"yToO1W2wRT"},{"type":"inlineCode","value":"fig.plot","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"zbRNMsytbS"},{"type":"text","value":"に渡す方法が今のところ不明です．\nそこで，","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"scmROL59qb"},{"type":"inlineCode","value":"for","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"noePN3eHgT"},{"type":"text","value":" 分で地震の個数回 ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"BdzTLhgMft"},{"type":"inlineCode","value":"plot","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"xQUJnxXqFD"},{"type":"text","value":" 命令を発行するという力技で解決しています．効率の良い方法とはいえず，一旦ファイルに落としてから読み込むほうが素直かもしれません．","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ixj7yQT1Lp"}],"key":"Hx7bJYnkzA"}],"visibility":"show","key":"PSwauWWGpo"}],"key":"iOuFwCNumN"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"メッシュデータの扱い","url":"/mesh","group":"基本編"},"next":{"title":"GMTの微調整","url":"/config","group":"応用編"}}},"domain":"http://localhost:3001"}