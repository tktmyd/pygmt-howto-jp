{"version":3,"kind":"Notebook","sha256":"d926579d680c60c7cae881bb022cf2e1a7c3101a828ddf357c254e6494a044b0","slug":"mesh","location":"/mesh.ipynb","dependencies":[],"frontmatter":{"title":"メッシュデータの扱い","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"seismo24","language":"python"},"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"github":"https://github.com/tktmyd/pygmt-howto-jp","copyright":"2021-2025. All Rights Reserved","settings":{"output_stderr":"remove-warn"},"numbering":{"title":{"offset":1}},"source_url":"https://github.com/tktmyd/pygmt-howto-jp/blob/main/src/mesh.ipynb","edit_url":"https://github.com/tktmyd/pygmt-howto-jp/edit/main/src/mesh.ipynb","exports":[{"format":"ipynb","filename":"mesh.ipynb","url":"/pygmt-howto-jp/build/mesh-97dc5ef3236073a5fef619bea60d8b80.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"inlineMath","value":"z(x,y)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>z</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">z(x,y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"F30Xvrl00H"},{"type":"text","value":" のような形式で，","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aBMm7coCIO"},{"type":"inlineMath","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"jdgt1fzwI7"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CbORgz6Uch"},{"type":"inlineMath","value":"y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"cyLqV5Iey1"},{"type":"text","value":"が等間隔のメッシュで与えられているデータを可視化してみます．\nここでは比較のためにmatplotlibも使います．","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SCPO3Eylk9"}],"key":"FKhJB3U6KE"}],"key":"a9I4d8SXgX"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import pygmt\nimport numpy as np\nimport matplotlib.pyplot as plt","visibility":"show","key":"leiwrBBusV"},{"type":"outputs","id":"6KTpkYHzBqdxbF1Ngia94","children":[],"visibility":"show","key":"BVwCzOD94d"}],"visibility":"show","key":"JaJCpMqpKm"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"等間隔メッシュデータ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jj44P8pOm2"}],"identifier":"id","label":"等間隔メッシュデータ","html_id":"id","implicit":true,"key":"FouNrgM4wZ"}],"visibility":"show","key":"eynyXjBqEf"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"まず，サンプルとして NumPy で適当な等間隔データを作成してみます．","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wQYQFHlp3F"}],"key":"TkwtwiI5sK"}],"visibility":"show","key":"V2rUu1dJid"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"nx = 300\nny = 200\nx = np.linspace(0, 3, nx+1)\ny = np.linspace(0, 2, ny+1)","visibility":"show","key":"NVDt7cJDd2"},{"type":"outputs","id":"xzZOhD1_rXQMHsKmUD0bl","children":[],"visibility":"show","key":"Q2yZI9hsax"}],"visibility":"show","key":"bFH88f6xFF"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"hRV8PIKRYU"}],"key":"vFYLoM4Dqf"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"長らくリスト ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"FGi8C5qRc2"},{"type":"inlineCode","value":"z","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"EVLOB1yfQQ"},{"type":"text","value":"の ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"OgFM4uiaaZ"},{"type":"inlineCode","value":"i,j","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"T9Kh0YAJYW"},{"type":"text","value":" の順序が逆になっていました（等方的な図のうえ，XY方向のサイズも等しいため気が付きませんでした．お詫びします．(2025/02/25)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hsfataCdzY"}],"key":"GdMumjA4Tw"}],"key":"Qs8akq5zUD"}],"visibility":"show","key":"BEYqSqYScj"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"z = np.zeros([ny+1,nx+1])\n\nfor i in range(nx):\n    for j in range(ny):\n        a = np.pi * ( x[i]    - np.sqrt(3.0) * y[j] )\n        b = np.pi * ( 3.*x[i] + np.sqrt(3.0) * y[j] )\n        z[j,i] = np.cos(2*a) * np.cos(4*b) + np.cos(5*a) * np.cos(3*b) + np.cos(7*a) * np.cos(b)","visibility":"show","key":"XroZBY9k7d"},{"type":"outputs","id":"sl0ujvxR0cWGWC4T8VKaE","children":[],"visibility":"show","key":"IAPYDVTgKH"}],"visibility":"show","key":"oa21IdwKj5"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"試しにmatplotlibでプロットしてみると，以下のような感じです．","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qrCeinYOXL"}],"key":"qSiA93Xsz3"}],"visibility":"show","key":"EmkdcGfKmQ"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"g = plt.subplot()\ng.pcolormesh(x, y, z, shading='auto')\ng.set_aspect('equal')","visibility":"show","key":"RIwpJ92fXh"},{"type":"outputs","id":"5ACifAnc9ahNgzTuM_mLn","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fbc802e38e212fe0673b41cafef12cd2","path":"/fbc802e38e212fe0673b41cafef12cd2.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"VA0O9dvGZR"}],"visibility":"show","key":"e7SGfwnbyC"}],"visibility":"show","key":"vwTz3VecvJ"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"このデータを pygmt の ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B6oFSmUFga"},{"type":"inlineCode","value":"xyz2grd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gNdKxKTXUI"},{"type":"text","value":" を用いて grdデータにしてプロットしてみます．","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QS0DlWrkUE"}],"key":"jxmu0VBqwF"}],"visibility":"show","key":"Z82haiGutE"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"K7C7nOx1No"}],"key":"t7eaqvS5VQ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"xyz2grd","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xxuDKlze6g"},{"type":"text","value":" はx, y, zそれぞれ1次元配列にしないと渡せないようです．そのため，","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Q9vodKhJPK"},{"type":"inlineCode","value":"np.meshgrid()","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XeQSVR8Qar"},{"type":"text","value":"と ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TRuQSOkAVM"},{"type":"inlineCode","value":"ravel()","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hIUCPfnZl3"},{"type":"text","value":" メソッドを通じて ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"M5OEflMyDt"},{"type":"inlineCode","value":"nx * ny","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PPLbTWSDTK"},{"type":"text","value":" サイズの1次元配列を作っています．","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tYFkvrrOsV"}],"key":"i1uLtcUxMB"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"もうすこしスッキリした書き方としては，","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yhODPTFP37"},{"type":"inlineCode","value":"x","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"u8Gg3woMsV"},{"type":"text","value":", ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FfO2YfWMNS"},{"type":"inlineCode","value":"y","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zVGlLqGMfc"},{"type":"text","value":", ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"k3IxUGefaN"},{"type":"inlineCode","value":"z","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ro7bWL1Kc0"},{"type":"text","value":"の代わりにそれらがパッキングされた","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NsgTNni7Rq"},{"type":"inlineCode","value":"data","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zLGtHnOREQ"},{"type":"text","value":"リストを内包表記を用いて与える方法もあります:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MoNQR5ipbF"}],"key":"Y2YtAd5z3x"},{"type":"code","lang":"python","value":"pygmt.xyz2grd(\n    data = [[x[i], y[j], z[i,j]] for i in range(len(x)) for j in range(len(y))]\n    # 他の要素は省略\n    )","position":{"start":{"line":6,"column":1},"end":{"line":11,"column":1}},"key":"mDN2t6Jcsg"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"さらに発展的な方法として，","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Lr4QZYs0gf"},{"type":"inlineCode","value":"xarray","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"VRmwg1Ybd5"},{"type":"text","value":" モジュールを用いて，以下のように表現することもできます．","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"nywjUrBElp"}],"key":"RvKpUmdz5q"},{"type":"code","lang":"python","value":"import xarray as xr\ngrddata = xr.DataArray(\n    data = z,\n    dims = [\"y\", \"x\"],\n    coords = {\"y\": y, \"x\": x}\n)","position":{"start":{"line":14,"column":1},"end":{"line":21,"column":1}},"key":"V0McJglQGi"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"この方法は高速なだけでなく，PyGMTがグリッドデータのPython内部オブジェクトとしてxarrayを用いている点からもより直接的で好ましい方法と思われます．","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"qyeSV4WupQ"},{"type":"inlineCode","value":"xyz2grd","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"UehcPPjDoe"},{"type":"text","value":"モジュールとことなり，わざわざxy方向のグリッド間隔を明示的に指定する必要がないのも好ましい点です．","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"M2qGGP7eIx"}],"key":"RwXVyLEx7H"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"この","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"qWSBZfI3pM"},{"type":"inlineCode","value":"xarray","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"wlVk1D1M8m"},{"type":"text","value":"を用いる方法は染矢さんに","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"xovDuNgMzo"},{"type":"link","url":"https://github.com/tktmyd/pygmt-howto-jp/issues/2","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"ご教示","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"EcuhACScm9"}],"urlSource":"https://github.com/tktmyd/pygmt-howto-jp/issues/2","data":{"kind":"issue","org":"tktmyd","repo":"pygmt-howto-jp","issue_number":"2"},"internal":false,"protocol":"github","key":"stNadoNzAE"},{"type":"text","value":"いただきました．記して感謝いたします．","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"fLtQa9drnl"}],"key":"gaxyoWyqUL"}],"key":"cBn24H5Y3r"}],"visibility":"show","key":"GF1SNyspYt"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = pygmt.Figure()\n\nX, Y = np.meshgrid(x, y)\n\ngrddata = pygmt.xyz2grd(\n    region = [0, 3, 0, 2],     \n    spacing = '0.01/0.01', \n    x = X.ravel(),\n    y = Y.ravel(), \n    z = z.ravel()\n)\n\npygmt.makecpt(\n    cmap       = 'viridis',     # 比較のためカラーパレットはほとんど同じものを使う\n    series     = [-3, 3, 1], \n    continuous = True\n)\n\nfig.grdimage(\n    grid       = grddata, \n    projection = 'X9c/6c', \n    frame      = ['WSen', 'xaf+lx', 'yaf+ly'],    \n)\n\nfig.grdcontour(\n    grid     = grddata, \n    levels   = 1, \n    pen      = 'default,black'\n)\n\nfig.colorbar(\n    position = '+e'    \n)\n\nfig.show()","visibility":"show","key":"QMoUBmdp63"},{"type":"outputs","id":"gdle-DpNgJcJR3VjawIQi","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{"image/png":{"width":500}},"data":{"image/png":{"content_type":"image/png","hash":"eeef1e2b4983510577ac612adb002fc1","path":"/eeef1e2b4983510577ac612adb002fc1.png"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"QRzgm9oopT"}],"visibility":"show","key":"LF6XpXFypf"}],"visibility":"show","key":"h0f3k1wqJh"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"ここでは，","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tdeILALsIx"},{"type":"inlineCode","value":"grdimage","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EVe9AEIwU1"},{"type":"text","value":"のほかに","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"apxh9RptOo"},{"type":"inlineCode","value":"grdcontour","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s5Gy4f8U6W"},{"type":"text","value":"も用いて等値線も描画してみました．使い方は上記の例を見ればほとんど明らかだと思います．","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OLIs3Uar4b"}],"key":"H6eCT9Up1c"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"wzIaw7yE8h"}],"key":"QwWczMiYXI"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"inlineCode","value":"grdcontour","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"CwohTFdlvV"},{"type":"text","value":" で等値線の間隔を指定するオプションは，従来は ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"H7tO0MbTxx"},{"type":"inlineCode","value":"intervals","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"job5rDOUc4"},{"type":"text","value":" でしたが，v0.12.0 からは ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"qHF7KEqvBm"},{"type":"inlineCode","value":"levels","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"B30dQX6qvX"},{"type":"text","value":" に変更されました．","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"XZIgUWVI7g"}],"key":"YW5QNvrymL"}],"key":"TcYxRyXL47"}],"visibility":"show","key":"IMWPGE9n0a"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2次元データの補間と可視化","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"w9MQ1l98Mm"}],"identifier":"id-2","label":"2次元データの補間と可視化","html_id":"id-2","implicit":true,"key":"umPKOWgWAh"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"続いて，粗いデータを補間しつつプロットしてみましょう．","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"p3d0DYryFF"}],"key":"Y2UEsSu4ka"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"サンプルデータとして，Wikipediaの","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ro3PS2RRcG"},{"type":"link","url":"https://en.wikipedia.org/wiki/Bicubic_interpolation","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"双3次補間","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KUiagb4vs1"}],"urlSource":"https://en.wikipedia.org/wiki/Bicubic_interpolation","data":{"page":"Bicubic_interpolation","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"WbIpsdFBTW"},{"type":"text","value":"の解説にある例を採用します．","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"sKSbF4lgOU"},{"type":"link","url":"https://commons.wikimedia.org/wiki/File:Interpolation-bicubic.svg","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"ここ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LGwdZTTJ5k"}],"urlSource":"https://commons.wikimedia.org/wiki/File:Interpolation-bicubic.svg","key":"gaAvcEGaVf"},{"type":"text","value":"からコードをお借りして（Creditはリンク先参照；CC-BY），以下のようなデータを使います．まずはデータ生成とmatplolibでの標準的可視化の例を示します．","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"RN4NYHrVBY"}],"key":"ldGl0MEaAg"}],"visibility":"show","key":"fB4tyO7xOf"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"METHODS = [ 'nearest', 'bilinear' ]\nCOLORS  = 'viridis'\n\nN = 5\nnp.random.seed(1)\ngrid = np.arange(0, N, 1)\ndata = np.round(np.random.rand(N, N), 1)\nmesh = np.meshgrid(grid, grid)\n\nfor interp in METHODS:\n\n    fig = plt.figure(figsize=(5,5))\n\n    ax = fig.add_axes([0.125, 0.175, 0.75, 0.75])\n    plt.imshow(data, interpolation=interp, cmap=COLORS, vmin=0, vmax=1)\n    plt.plot(mesh[0], mesh[1], marker='.', ms=8, color='k', lw=0)\n    plt.title(interp, weight='bold')\n    plt.xlim(grid.min()-0.5, grid.max()+0.5)\n    plt.ylim(grid.min()-0.5, grid.max()+0.5)\n    plt.xticks(grid)\n    plt.yticks(grid)\n\n    cax = fig.add_axes([0.125, 0.075, 0.75, 0.03])\n    cb = plt.colorbar(cax=cax, orientation='horizontal',\n                      ticks=np.linspace(0, 1, 6))\n    cb.solids.set_edgecolor('face')","visibility":"show","key":"XQr6ZygWnO"},{"type":"outputs","id":"lPhDjHxBFnp29ohwOJSxX","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1259e2a3243886093de9f4cab2c04050","path":"/1259e2a3243886093de9f4cab2c04050.png"},"text/plain":{"content":"<Figure size 500x500 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"G84eXQ5sQX"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"edbd425a7024c851e1cbff6d3a55929a","path":"/edbd425a7024c851e1cbff6d3a55929a.png"},"text/plain":{"content":"<Figure size 500x500 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"ggFhZj82N7"}],"visibility":"show","key":"G59Ic06IxT"}],"visibility":"show","key":"x2yjUA29xR"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"ここで作られたデータを ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gkt5SDtaKG"},{"type":"inlineCode","value":"ravel()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dot90UQ7Q1"},{"type":"text","value":"メソッド1次元化し，","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iOlzzcVMvV"},{"type":"inlineCode","value":"pygmt.surface","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VLjZtonVzw"},{"type":"text","value":"で補間をしてみます．比較のため ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZheFMmw2Jx"},{"type":"inlineCode","value":"pygmt.xyz2grd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P0g5vnSpuf"},{"type":"text","value":" で粗い間隔のままのプロットも作成します．","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rfTwr4uvU8"}],"key":"HGcezNhA2j"}],"visibility":"show","key":"LOSoohWQ9y"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = pygmt.Figure()\n\ngriddata_s = pygmt.surface(\n    x       = mesh[0].ravel(), \n    y       = mesh[1].ravel(), \n    z       = data.ravel(), \n    region  = [-0.5, 4.5, -0.5, 4.5], \n    spacing = '0.02/0.02',\n    tension = 0.5 # 無指定は0\n)\n\ngriddata_x = pygmt.xyz2grd(\n    x       = mesh[0].ravel(), \n    y       = mesh[1].ravel(), \n    z       = data.ravel(), \n    region  = [-0.5, 4.5, -0.5, 4.5], \n    spacing = '1/1',\n    registration = 'p'\n)\n\n\npygmt.makecpt(\n    cmap = 'viridis', \n    series = [0, 1, 0.1], \n    continuous = True\n)\n\nfig.grdimage(\n    grid = griddata_x, \n    projection = 'X10c/10c',\n    frame = ['WSen+tGMT xyz2grd', 'xaf', 'yaf'], \n)\n\nfig.plot(\n    x = mesh[0].ravel(), \n    y = mesh[1].ravel(), \n    style = 'c0.2c', \n    fill  = 'black', \n)\n\n# 右にずれる\nfig.shift_origin( xshift = 11 )\n\nfig.grdimage(\n    grid = griddata_s, \n    projection = 'X10c/10c',\n    frame = ['WSen+tGMT surface', 'xaf', 'yaf']    \n)\n\nfig.grdcontour( \n    grid = griddata_s, \n    pen = 'default,black', \n    annotation = '-'\n)\n\nfig.plot(\n    x = mesh[0].ravel(), \n    y = mesh[1].ravel(), \n    style = 'c0.2c', \n    fill  = 'black', \n)\n\nfig.colorbar(\n    position = '+e'    \n)\n\nfig.show()","visibility":"show","key":"YS0Ke3j5cg"},{"type":"outputs","id":"aPcOWLOBoj98CB1tVoNfN","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{"image/png":{"width":500}},"data":{"image/png":{"content_type":"image/png","hash":"4a828d18b054e1ef412cd3e1594dedb6","path":"/4a828d18b054e1ef412cd3e1594dedb6.png"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"Hw2mCT8DRJ"}],"visibility":"show","key":"uJ1RwsKRP8"}],"visibility":"show","key":"LWcWmSlnxz"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"ZFmL51FaWK"}],"key":"a18ojp1fF8"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"inlineCode","value":"pygmt.surface","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zoSwlcOBZF"},{"type":"text","value":" は tension factor ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BnJlFxxPWX"},{"type":"inlineMath","value":"t","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"NDqTxhPRrd"},{"type":"text","value":" という量で補間の状況をコントロールします．その値を指定するオリジナルのGMTの ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"WL1CAvKU4l"},{"type":"inlineCode","value":"-T","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"o6d6yD3pLp"},{"type":"text","value":" オプションは，v0.8.0までが正式には実装されていませんでしたが， ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"y1DjKGZRYW"},{"type":"inlineCode","value":"pygmt.surface{T = }","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"QAM5dIKzKD"},{"type":"text","value":" とすると動作する状態でした．この ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"iJUcrArTtt"},{"type":"inlineCode","value":"T","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"iTmmKtmdN0"},{"type":"text","value":" はオリジナルのGMTの","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"eCCvDBLDMU"},{"type":"inlineCode","value":"surface","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"YcZXnkgSpK"},{"type":"text","value":"モジュールのオプション名です．","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"u2sqcychL4"}],"key":"g2X4CMbaIs"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"v0.9.0から公式に ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"nWN2HXOXzh"},{"type":"inlineCode","value":"pygmt.surface","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kzuFbY6IxH"},{"type":"text","value":" に GMTの","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ZBmw5gmiY7"},{"type":"inlineCode","value":"T","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"vXyTi9atwf"},{"type":"text","value":"オプションに相当する","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kXZOsjUfvU"},{"type":"inlineCode","value":"tension","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"cy9Di4SMdq"},{"type":"text","value":"オプションが実装されたようです．","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"aQvfTOD5l1"}],"key":"WoE0nBtSm2"}],"key":"jMThTBBXh7"}],"visibility":"show","key":"zYEavrZZcj"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"surface","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gcGvWB3uGt"},{"type":"text","value":"による補間の挙動は，","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mqApY6dzXI"},{"type":"inlineCode","value":"tension","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PymFagqejx"},{"type":"text","value":"パラメタによってだいぶ変わります．","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S5cqppjXuQ"},{"type":"inlineCode","value":"tension","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LEHjllj2Iz"},{"type":"text","value":"を変えてみて，補間の違いを見てみましょう．","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YQwzT2iVUP"}],"key":"T56TcEvpFo"}],"key":"dK7BYiEmMV"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = pygmt.Figure()\n\npygmt.makecpt(\n    cmap = 'viridis', \n    series = [0, 1, 0.1], \n    continuous = True\n)\n\ngriddata_s0 = pygmt.surface(\n    x       = mesh[0].ravel(), \n    y       = mesh[1].ravel(), \n    z       = data.ravel(), \n    region  = [-0.5, 4.5, -0.5, 4.5], \n    spacing = '0.02/0.02',\n    tension = 0.0 \n)\ngriddata_s1 = pygmt.surface(\n    x       = mesh[0].ravel(), \n    y       = mesh[1].ravel(), \n    z       = data.ravel(), \n    region  = [-0.5, 4.5, -0.5, 4.5], \n    spacing = '0.02/0.02',\n    tension = 0.5 \n)\ngriddata_s2 = pygmt.surface(\n    x       = mesh[0].ravel(), \n    y       = mesh[1].ravel(), \n    z       = data.ravel(), \n    region  = [-0.5, 4.5, -0.5, 4.5], \n    spacing = '0.02/0.02',\n    tension = 1.0 \n)\n\n\nfig.grdimage(\n    grid = griddata_s0, \n    projection = 'X10c/10c',\n    frame = ['WSen+ttension = 0.0', 'xaf', 'yaf']    \n)\n\nfig.grdcontour( \n    grid = griddata_s0, \n    pen = 'default,black', \n    annotation = '-'\n)\n\nfig.plot(\n    x = mesh[0].ravel(), \n    y = mesh[1].ravel(), \n    style = 'c0.2c', \n    fill  = 'black', \n)\n\n# 右にずれる\nfig.shift_origin( xshift = 11 )\n\nfig.grdimage(\n    grid = griddata_s1, \n    projection = 'X10c/10c',\n    frame = ['WSen+ttension = 0.5', 'xaf', 'yaf']    \n)\n\nfig.grdcontour( \n    grid = griddata_s1, \n    pen = 'default,black', \n    annotation = '-'\n)\n\nfig.plot(\n    x = mesh[0].ravel(), \n    y = mesh[1].ravel(), \n    style = 'c0.2c', \n    fill  = 'black', \n)\n\nfig.colorbar(\n    position = '+e'    \n)\n\n# 右にずれる\nfig.shift_origin( xshift = 11 )\n\n\nfig.grdimage(\n    grid = griddata_s2, \n    projection = 'X10c/10c',\n    frame = ['WSen+ttension = 1.0', 'xaf', 'yaf']    \n)\n\nfig.grdcontour( \n    grid = griddata_s2, \n    pen = 'default,black', \n    annotation = '-'\n)\n\nfig.plot(\n    x = mesh[0].ravel(), \n    y = mesh[1].ravel(), \n    style = 'c0.2c', \n    fill  = 'black', \n)\n\nfig.show()","visibility":"show","key":"valudf5d39"},{"type":"outputs","id":"GNupi3ZV7oeRvseLXPyQL","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{"image/png":{"width":500}},"data":{"image/png":{"content_type":"image/png","hash":"601d876ffb4f14a0f91dd1313535f053","path":"/601d876ffb4f14a0f91dd1313535f053.png"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"AbaQMgNNkF"}],"visibility":"show","key":"P93gFD9kf2"}],"visibility":"show","key":"hs3RhqUkon"}],"key":"UFJb2NxnGj"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"地図上への情報描画","url":"/inf-on-map","group":"基本編"},"next":{"title":"時系列データの可視化","url":"/timeseries","group":"基本編"}}},"domain":"http://localhost:3001"}